{"version":3,"file":"/js/yptSearch.js","mappings":"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","sources":["webpack://good-guitarist/./assets/src/scripts/yptSearch.js","webpack://good-guitarist/external window \"jQuery\"","webpack://good-guitarist/webpack/bootstrap"],"sourcesContent":["'use strict';\nconst { chunk } = lodash;\n\n/**\n * Add search action and verify the form checkboxes. Return their data.\n *\n * @param {HTMLElement} form\n * @param {Array|null} songFilterCheckboxes\n * @returns {array}\n */\nconst verifyAndReturnSearchFormData = ( form, songFilterCheckboxes ) => {\n\tconst formData = {\n\t\taction: \"ypt_ajax_filter_search\",\n\t\tsongSearchText: (0 !== form.find(\"#songSearchText\").val().length) ? form.find(\"#songSearchText\").val() : null,\n\t};\n\n\tif (songFilterCheckboxes) {\n\t\tsongFilterCheckboxes.forEach((val) => {\n\t\t\tformData[val] = getCheckedSongFilters(val);\n\t\t});\n\t}\n\n\treturn formData;\n}\n\n/**\n * Find all the checked song filters and return the selections.\n *\n * @param {string} inputName The name of the checkbox fieldset to get data from.\n * @returns {Array}\n */\nconst getCheckedSongFilters = ( inputName ) => {\n\tlet value = [];\n\tconst inputs = document.querySelectorAll(`#ypt-ajax-filter-search input[name=\"${inputName}\"]:checked`);\n\tArray.prototype.forEach.call(inputs, (element) => {\n\t\tconsole.log('the element', element.id)\n\t\tif ('radio' === element.type) {\n\t\t\tvalue = element.value;\n\t\t} else if ('checkbox' === element.type && \"contains-one-barre-chord\" !== element.id) {\n\t\t\tvalue.push(element.value);\n\t\t} else if (\"contains-one-barre-chord\" === element.id) {\n\t\t\tvalue = element.checked;\n\t\t}\n\t});\n\treturn value;\n}\n\n/**\n * Send the AJAX request to the server. Check if the search results element\n * can be found before making the request.\n *\n * @param {HTMLElement} yptSearchResultsElement\n * @param {Object} searchFormData\n * @returns {undefined}\n */\nconst sendAjaxRequest = ( yptSearchResultsElement, searchFormData ) => {\n\tconst yptSearchResultsCountElement = $('.search-results-count .count');\n\tif (yptSearchResultsElement) {\n\t\t$.ajax({\n\t\t\t// Global variable YPTSEARCHAJAX created by wp_inline_script().\n\t\t\turl : YPTSEARCHAJAX.ajax_url,\n\t\t\tdata : searchFormData,\n\t\t\tsuccess : (response) => {\n\t\t\t\tconsole.log(\" the response is\", response);\n\t\t\t\typtSearchResultsElement.empty();\n\t\t\t\typtSearchResultsCountElement.each(function() {\n\t\t\t\t\t$(this).text(response.data.length);\n\t\t\t\t});\n\t\t\t\tpaginateSearchResults(response.data, yptSearchResultsElement);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n *\n * @param {*} results\n * @param {*} yptSearchResultsElement\n */\nconst populateSearchResults = (results, yptSearchResultsElement) => {\n\tresults.forEach((post) => {\n\t\tlet html = \"<li class='ypt-result' id='ypt-\" + post.id + \"'>\";\n\t\thtml += \"  <a href='\" + post.permalink + \"' title='\" + post.title + \"'>\";\n\t\thtml += \"\t   <img src='\" + post.content[0].attrs.videoThumbnail + \"' />\";\n\t\thtml += \"      <div class='ypt-info'>\";\n\t\thtml += \"          <h3>\" + post.title + \"</h3>\";\n\t\thtml += \"      </div>\";\n\t\thtml += \"  </a>\";\n\t\thtml += \"</li>\";\n\n\t\typtSearchResultsElement.append(html);\n\t});\n}\n\n/**\n *\n * @param {*} results\n * @param {*} yptSearchResultsElement\n */\nconst paginateSearchResults = (results, yptSearchResultsElement, yptSearchResultsCountElement) => {\n\tconst resultsPerPage = 6;\n\tconst yptSearchPreviousPageButton = $('.search-results-controls .previous-page');\n\tconst yptSearchNextPageButton = $('.search-results-controls .next-page');\n\tconst yptSearchResultsPageCountElement = $('.search-results-page-count');\n\typtSearchPreviousPageButton.prop(\"disabled\", false).css(\"cursor\", \"pointer\");\n\typtSearchNextPageButton.prop(\"disabled\", false).css(\"cursor\", \"pointer\");\n\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\typtSearchResultsPageCountElement.find('.last-page').text('1');\n\typtSearchResultsElement.empty();\n\tif (results.length >= resultsPerPage) {\n\t\tconst chunkedResults = chunk(results, resultsPerPage);\n\t\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\t\typtSearchResultsPageCountElement.find('.last-page').text(chunkedResults.length);\n\t\tpopulateSearchResults(chunkedResults[0], yptSearchResultsElement, yptSearchResultsCountElement);\n\t\t// Event listeners for previous and next page buttons.\n\t\typtSearchPreviousPageButton.on('click', (e) => {\n\t\t\tconst newPageCount = updatePageCount(e.target, false, chunkedResults.length, yptSearchResultsPageCountElement);\n\t\t\typtSearchResultsElement.empty();\n\t\t\tpopulateSearchResults(chunkedResults[newPageCount], yptSearchResultsElement, yptSearchResultsCountElement);\n\t\t});\n\t\typtSearchNextPageButton.on('click', (e) => {\n\t\t\tconst newPageCount = updatePageCount(e.target, true, chunkedResults.length, yptSearchResultsPageCountElement);\n\t\t\typtSearchResultsElement.empty();\n\t\t\tpopulateSearchResults(chunkedResults[newPageCount], yptSearchResultsElement, yptSearchResultsCountElement);\n\t\t});\n\t} else {\n\t\tpopulateSearchResults(results, yptSearchResultsElement, yptSearchResultsCountElement);\n\t\typtSearchPreviousPageButton.prop(\"disabled\", true).css(\"cursor\", \"not-allowed\");\n\t\typtSearchNextPageButton.prop(\"disabled\", true).css(\"cursor\", \"not-allowed\");\n\t\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\t\typtSearchResultsPageCountElement.find('.last-page').text('1');\n\t}\n\n}\n\n/**\n *\n * @param {*} changePageButton\n * @param {*} increasePage\n * @param {*} pageCount\n * @param {*} yptSearchResultsPageCountElement\n * @returns\n */\nconst updatePageCount = (changePageButton, increasePage, pageCount, yptSearchResultsPageCountElement) => {\n\tconst $pageCountElement = $(changePageButton).parent().first().find('.search-results-page-count .current-page').first();\n\tlet currentPage = Number($pageCountElement.data('page'));\n\tlet humanCurrentPage = currentPage + 1;\n\n\tif (increasePage) {\n\t\tif (currentPage < pageCount - 1) {\n\t\t\typtSearchResultsPageCountElement.find('.current-page').text(humanCurrentPage + 1);\n\t\t\t$pageCountElement.data('page', currentPage + 1);\n\t\t}\n\t} else if (currentPage > 0) {\n\t\typtSearchResultsPageCountElement.find('.current-page').text(humanCurrentPage - 1);\n\t\t$pageCountElement.data('page', currentPage - 1);\n\t}\n\n\treturn $pageCountElement.data('page');\n}\n\n\n/**\n * Set aria-expanded attributes for mobile devices(less than 901px wide).\n *\n * @param {HTMLElement} buttonElement\n */\nconst setSearchFiltersAriaExpandedIfMobile = (buttonElement) => {\n\tif ( window.innerWidth < 901) {\n\t\tbuttonElement.setAttribute('aria-expanded', \"false\");\n\t} else {\n\t\tbuttonElement.setAttribute('aria-expanded', \"true\");\n\t}\n}\n\n/**\n * Allow search filters to collapse and expand on mobile(less than 901px wide).\n */\nconst searchFiltersMobile = () => {\n\tconst searchFiltersButtonElement = document.querySelector('.filters-expand-button');\n\tconst searchFiltersButtonArrowElement = searchFiltersButtonElement.querySelector('span');\n\tconst searchFiltersElement = document.querySelector('.search-filters-section');\n\n\twindow.addEventListener(\"resize\", () => {\n\t\tsetSearchFiltersAriaExpandedIfMobile();\n\t\tif ( window.innerWidth < 901) {\n\t\t\tsearchFiltersElement.style.height = \"0px\";\n\t\t} else {\n\t\t\tsearchFiltersElement.style.height = \"450px\";\n\t\t}\n\t});\n\n\tsetSearchFiltersAriaExpandedIfMobile(searchFiltersButtonElement);\n\tsearchFiltersButtonElement.addEventListener(\"click\", (e) => {\n\t\te.preventDefault();\n\t\tif (\"true\" === searchFiltersButtonElement.getAttribute(\"aria-expanded\")) {\n\t\t\tsearchFiltersElement.style.height = \"0px\";\n\t\t\tsearchFiltersButtonElement.setAttribute('aria-expanded', \"false\");\n\t\t\tsearchFiltersButtonArrowElement.style.transform = \"rotate(0deg)\";\n\t\t} else if (\"false\" === searchFiltersButtonElement.getAttribute(\"aria-expanded\")) {\n\t\t\tsearchFiltersElement.style.height = \"450px\";\n\t\t\tsearchFiltersButtonElement.setAttribute('aria-expanded', \"true\");\n\t\t\tsearchFiltersButtonArrowElement.style.transform = \"rotate(180deg)\";\n\t\t}\n\t});\n}\n\n/**\n * IIFE.\n *\n *\n */\n(($) => {\n\tconst songFilterCheckboxes = [\n\t\t'songDecade',\n\t\t'songChords',\n\t\t'songChordsFilterType',\n\t\t'songGenre',\n\t\t'songBeginner',\n\t\t'songDifficulty',\n\t\t'songContainsOneBarre'\n\t];\n\tconst yptSearchBlock = $(\"#ypt-ajax-filter-search\");\n\tconst yptSearchFiltersForm = yptSearchBlock.find(\"form\");\n\tconst yptSearchResultsElement = yptSearchBlock.find(\"#ypt-ajax-search-results\");\n\tconsole.log('hello')\n\n\typtSearchFiltersForm.on('submit',(e) => {\n\t\tconst searchFormData = verifyAndReturnSearchFormData(yptSearchFiltersForm, songFilterCheckboxes);\n\t\tconsole.log('form data', searchFormData)\n\t\te.preventDefault();\n\t\tsendAjaxRequest(yptSearchResultsElement, searchFormData);\n\t});\n\n\tsearchFiltersMobile();\n\n\t// Run request on page load for initial results.\n\tconst searchFormData = verifyAndReturnSearchFormData(yptSearchFiltersForm, null);\n\tsendAjaxRequest(yptSearchResultsElement, searchFormData);\n\n})(jQuery);\n\n\n\n\n","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n"],"names":["chunk","verifyAndReturnSearchFormData","getCheckedSongFilters","sendAjaxRequest","populateSearchResults","paginateSearchResults","updatePageCount","setSearchFiltersAriaExpandedIfMobile","module","exports","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","lodash","form","songFilterCheckboxes","formData","action","songSearchText","find","val","length","forEach","inputName","value","inputs","document","querySelectorAll","Array","prototype","call","element","console","log","id","type","push","checked","yptSearchResultsElement","searchFormData","yptSearchResultsCountElement","$","ajax","url","YPTSEARCHAJAX","ajax_url","data","success","response","empty","each","this","text","results","post","html","permalink","title","content","attrs","videoThumbnail","append","yptSearchPreviousPageButton","yptSearchNextPageButton","yptSearchResultsPageCountElement","prop","css","chunkedResults","on","e","newPageCount","target","changePageButton","increasePage","pageCount","$pageCountElement","parent","first","currentPage","Number","humanCurrentPage","buttonElement","innerWidth","setAttribute","searchFiltersButtonElement","searchFiltersButtonArrowElement","searchFiltersElement","yptSearchBlock","yptSearchFiltersForm","preventDefault","querySelector","addEventListener","style","height","getAttribute","transform","jQuery"],"sourceRoot":""}