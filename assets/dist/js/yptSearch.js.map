{"version":3,"file":"/js/yptSearch.js","mappings":"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","sources":["webpack://good-guitarist/./assets/src/scripts/yptSearch.js","webpack://good-guitarist/external window \"jQuery\"","webpack://good-guitarist/webpack/bootstrap"],"sourcesContent":["const { chunk } = lodash;\n\n/**\n * Add search action and verify the form checkboxes. Return their data.\n *\n * @param {HTMLElement} form HTML search form.\n * @param {Array|null} songFilterCheckboxes HTML checkboxes to get search data from.\n * @returns {FormData}\n */\nconst verifyAndReturnSearchFormData = ( form, songFilterCheckboxes ) => {\n\tconst formData = {\n\t\taction: \"ypt_ajax_filter_search\",\n\t\tsongSearchText: (0 !== form.find(\"#songSearchText\").val().length) ? form.find(\"#songSearchText\").val() : null,\n\t};\n\n\tif (songFilterCheckboxes) {\n\t\tsongFilterCheckboxes.forEach((val) => {\n\t\t\tformData[val] = getCheckedSongFilters(val);\n\t\t});\n\t}\n\n\treturn formData;\n}\n\n/**\n * Find all the checked song filters and return the selections.\n *\n * @param {string} inputName The name of the checkbox fieldset to get data from.\n * @returns {array}\n */\nconst getCheckedSongFilters = ( inputName ) => {\n\tlet value = [];\n\tconst inputs = document.querySelectorAll(`#ypt-ajax-filter-search input[name=\"${inputName}\"]:checked`);\n\tArray.prototype.forEach.call(inputs, (element) => {\n\t\tif ('radio' === element.type) {\n\t\t\tvalue = element.value;\n\t\t} else if ('checkbox' === element.type && \"contains-one-barre-chord\" !== element.id) {\n\t\t\tvalue.push(element.value);\n\t\t} else if (\"contains-one-barre-chord\" === element.id) {\n\t\t\tvalue = element.checked;\n\t\t}\n\t});\n\treturn value;\n}\n\n/**\n * Send the AJAX request to the server. Check if the search results element\n * can be found before making the request.\n *\n * @param {HTMLElement} yptSearchResultsElement\n * @param {Object} searchFormData\n * @returns {void}\n */\nconst sendAjaxRequest = ( yptSearchResultsElement, searchFormData ) => {\n\tconst yptSearchResultsCountElement = $('.search-results-count .count');\n\tif (yptSearchResultsElement) {\n\t\t$.ajax({\n\t\t\t// Global variable YPTSEARCHAJAX created by wp_inline_script().\n\t\t\turl : YPTSEARCHAJAX.ajax_url,\n\t\t\tdata : searchFormData,\n\t\t\tsuccess : (response) => {\n\t\t\t\tconsole.log('the result', response)\n\t\t\t\typtSearchResultsElement.empty();\n\t\t\t\typtSearchResultsCountElement.each(function() {\n\t\t\t\t\t$(this).text(response.data.length);\n\t\t\t\t});\n\t\t\t\tpaginateSearchResults(response.data, yptSearchResultsElement);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * Add HTML for each search result returned.\n * \n * @param {*} results All search results.\n * @param {*} yptSearchResultsElement HTML element to append results to.\n * @return {void}\n */\nconst populateSearchResults = (results, yptSearchResultsElement) => {\n\tresults.forEach((post) => {\n\t\tconst videoThumbnail = post.content.length > 0 ? post.content[0]?.attrs?.videoThumbnail : '';\n\t\tlet html = \"<li class='ypt-result' id='ypt-\" + post.id + \"'>\";\n\t\thtml += \"  <a href='\" + post.permalink + \"' title='\" + post.title + \"'>\";\n\t\thtml += \"\t   <img src='\" + videoThumbnail + \"' />\";\n\t\thtml += \"      <div class='ypt-info'>\";\n\t\thtml += \"          <h3>\" + post.title + \"</h3>\";\n\t\thtml += \"      </div>\";\n\t\thtml += \"  </a>\";\n\t\thtml += \"</li>\";\n\n\t\typtSearchResultsElement.append(html);\n\t});\n}\n\n/**\n * Break up search results into pages to allow the user to scroll through them chunk by chunk.\n * \n * @param {array} results Search results to break into sections(paginate).\n * @param {*} yptSearchResultsElement The HTML element where the search results populate into.\n * @param {*} yptSearchResultsCountElement The HTML element that displays the number of search results.\n * @return {void}\n */\nconst paginateSearchResults = (results, yptSearchResultsElement, yptSearchResultsCountElement) => {\n\tconst resultsPerPage = 6;\n\tconst yptSearchPreviousPageButton = $('.search-results-controls .previous-page');\n\tconst yptSearchNextPageButton = $('.search-results-controls .next-page');\n\tconst yptSearchResultsPageCountElement = $('.search-results-page-count');\n\typtSearchPreviousPageButton.prop(\"disabled\", false).css(\"cursor\", \"pointer\");\n\typtSearchNextPageButton.prop(\"disabled\", false).css(\"cursor\", \"pointer\");\n\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\typtSearchResultsPageCountElement.find('.last-page').text('1');\n\typtSearchResultsElement.empty();\n\t\n\tif (results.length >= resultsPerPage) {\n\t\tconst chunkedResults = chunk(results, resultsPerPage);\n\t\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\t\typtSearchResultsPageCountElement.find('.last-page').text(chunkedResults.length);\n\t\tpopulateSearchResults(chunkedResults[0], yptSearchResultsElement, yptSearchResultsCountElement);\n\n\t\t// Event listeners for previous and next page buttons.\n\t\typtSearchPreviousPageButton.on('click', (e) => {\n\t\t\tconst newPageCount = updatePageCount(e.target, false, chunkedResults.length, yptSearchResultsPageCountElement);\n\t\t\typtSearchResultsElement.empty();\n\t\t\tpopulateSearchResults(chunkedResults[newPageCount], yptSearchResultsElement, yptSearchResultsCountElement);\n\t\t});\n\t\typtSearchNextPageButton.on('click', (e) => {\n\t\t\tconst newPageCount = updatePageCount(e.target, true, chunkedResults.length, yptSearchResultsPageCountElement);\n\t\t\typtSearchResultsElement.empty();\n\t\t\tpopulateSearchResults(chunkedResults[newPageCount], yptSearchResultsElement, yptSearchResultsCountElement);\n\t\t});\n\n\t} else {\n\t\tpopulateSearchResults(results, yptSearchResultsElement, yptSearchResultsCountElement);\n\t\typtSearchPreviousPageButton.prop(\"disabled\", true).css(\"cursor\", \"not-allowed\");\n\t\typtSearchNextPageButton.prop(\"disabled\", true).css(\"cursor\", \"not-allowed\");\n\t\typtSearchResultsPageCountElement.find('.current-page').text('1');\n\t\typtSearchResultsPageCountElement.find('.last-page').text('1');\n\t}\n\n}\n\n/**\n * Handler for updating the page count of search results.\n * \n * @param {*} changePageButton \n * @param {*} increasePage\n * @param {*} pageCount\n * @param {*} yptSearchResultsPageCountElement\n * @return {string}\n */\nconst updatePageCount = (changePageButton, increasePage, pageCount, yptSearchResultsPageCountElement) => {\n\tconst $pageCountElement = $(changePageButton).parent().first().find('.search-results-page-count .current-page').first();\n\tlet currentPage = Number($pageCountElement.data('page'));\n\tlet humanCurrentPage = currentPage + 1;\n\n\tif (increasePage) {\n\t\tif (currentPage < pageCount - 1) {\n\t\t\typtSearchResultsPageCountElement.find('.current-page').text(humanCurrentPage + 1);\n\t\t\t$pageCountElement.data('page', currentPage + 1);\n\t\t}\n\t} else if (currentPage > 0) {\n\t\typtSearchResultsPageCountElement.find('.current-page').text(humanCurrentPage - 1);\n\t\t$pageCountElement.data('page', currentPage - 1);\n\t}\n\n\treturn $pageCountElement.data('page');\n}\n\n\n/**\n * Set aria-expanded attributes for mobile devices(less than 901px wide).\n *\n * @param {HTMLElement} buttonElement\n */\nconst setSearchFiltersAriaExpandedIfMobile = (buttonElement) => {\n\tif ( window.innerWidth < 901) {\n\t\tbuttonElement.setAttribute('aria-expanded', \"false\");\n\t} else {\n\t\tbuttonElement.setAttribute('aria-expanded', \"true\");\n\t}\n}\n\n/**\n * Allow search filters to collapse and expand on mobile(less than 901px wide).\n */\nconst searchFiltersMobile = () => {\n\tconst searchFiltersButtonElement = document.querySelector('.filters-expand-button');\n\tconst searchFiltersButtonArrowElement = searchFiltersButtonElement.querySelector('span');\n\tconst searchFiltersElement = document.querySelector('.search-filters-section');\n\n\twindow.addEventListener(\"resize\", () => {\n\t\tsetSearchFiltersAriaExpandedIfMobile(searchFiltersButtonElement);\n\t\tif ( window.innerWidth < 901) {\n\t\t\tsearchFiltersElement.style.height = \"0px\";\n\t\t} else {\n\t\t\tsearchFiltersElement.style.height = \"450px\";\n\t\t}\n\t});\n\n\tsetSearchFiltersAriaExpandedIfMobile(searchFiltersButtonElement);\n\tsearchFiltersButtonElement.addEventListener(\"click\", (e) => {\n\t\te.preventDefault();\n\t\tif (\"true\" === searchFiltersButtonElement.getAttribute(\"aria-expanded\")) {\n\t\t\tsearchFiltersElement.style.height = \"0px\";\n\t\t\tsearchFiltersButtonElement.setAttribute('aria-expanded', \"false\");\n\t\t\tsearchFiltersButtonArrowElement.style.transform = \"rotate(0deg)\";\n\t\t} else if (\"false\" === searchFiltersButtonElement.getAttribute(\"aria-expanded\")) {\n\t\t\tsearchFiltersElement.style.height = \"450px\";\n\t\t\tsearchFiltersButtonElement.setAttribute('aria-expanded', \"true\");\n\t\t\tsearchFiltersButtonArrowElement.style.transform = \"rotate(180deg)\";\n\t\t}\n\t});\n}\n\n/**\n * IIFE.\n *\n *\n */\n(($) => {\n\tconst songFilterCheckboxes = [\n\t\t'songDecade',\n\t\t'songChords',\n\t\t'songChordsFilterType',\n\t\t'songGenre',\n\t\t'songFeel',\n\t\t'songBeginner',\n\t\t'songDifficulty',\n\t\t'songContainsOneBarre'\n\t];\n\tconst yptSearchBlock = $(\"#ypt-ajax-filter-search\");\n\tconst yptSearchFiltersForm = yptSearchBlock.find(\"form\");\n\tconst yptSearchResultsElement = yptSearchBlock.find(\"#ypt-ajax-search-results\");\n\n\typtSearchFiltersForm.trigger('reset');\n\typtSearchFiltersForm.on('submit',(e) => {\n\t\tconst searchFormData = verifyAndReturnSearchFormData(yptSearchFiltersForm, songFilterCheckboxes);\n\t\te.preventDefault();\n\t\tsendAjaxRequest(yptSearchResultsElement, searchFormData);\n\t});\n\n\tsearchFiltersMobile();\n\n\t// Run request on page load for initial results.\n\tconst searchFormData = verifyAndReturnSearchFormData(yptSearchFiltersForm, null);\n\tsendAjaxRequest(yptSearchResultsElement, searchFormData);\n\n})(jQuery);\n\n\n\n\n","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n"],"names":["chunk","verifyAndReturnSearchFormData","getCheckedSongFilters","sendAjaxRequest","populateSearchResults","paginateSearchResults","updatePageCount","setSearchFiltersAriaExpandedIfMobile","module","exports","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","lodash","form","songFilterCheckboxes","formData","action","songSearchText","find","val","length","forEach","inputName","value","inputs","document","querySelectorAll","Array","prototype","call","element","type","id","push","checked","yptSearchResultsElement","searchFormData","yptSearchResultsCountElement","$","ajax","url","YPTSEARCHAJAX","ajax_url","data","success","response","console","log","empty","each","this","text","results","post","videoThumbnail","content","_post$content$","attrs","_post$content$$attrs","html","permalink","title","append","yptSearchPreviousPageButton","yptSearchNextPageButton","yptSearchResultsPageCountElement","prop","css","chunkedResults","on","e","newPageCount","target","changePageButton","increasePage","pageCount","$pageCountElement","parent","first","currentPage","Number","humanCurrentPage","buttonElement","innerWidth","setAttribute","searchFiltersButtonElement","searchFiltersButtonArrowElement","searchFiltersElement","yptSearchBlock","yptSearchFiltersForm","trigger","preventDefault","querySelector","addEventListener","style","height","getAttribute","transform","jQuery"],"sourceRoot":""}